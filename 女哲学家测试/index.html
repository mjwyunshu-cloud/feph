<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>镜像之思 | 女哲学家探测报告</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@200;500;700;900&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-paper: #FBFCFA;
            --charcoal: #302D2D;
            --teal: #169cb2;
            --border-fine: rgba(48, 45, 45, 0.04);
        }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background-color: var(--bg-paper);
            color: var(--charcoal);
            -webkit-font-smoothing: antialiased;
        }

        .serif { font-family: 'Noto Serif SC', serif; }
        
        /* 策展黑主题 */
        .theme-charcoal {
            background-color: var(--charcoal);
            color: var(--bg-paper);
        }

        /* 极致紧凑长条 - 去除多余Gap */
        .long-strip-container {
            display: flex;
            flex-direction: column;
            gap: 0.5rem; 
            width: 100%;
            max-width: 365px; 
        }

        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .metadata {
            font-size: 8px;
            letter-spacing: 0.25em;
            text-transform: uppercase;
            color: #A39F9F;
            font-weight: 600;
        }

        .option-box {
            transition: all 0.2s ease;
            background: white;
            border: 0.5px solid var(--border-fine);
            font-size: 13.5px;
            line-height: 1.5;
            cursor: pointer;
            padding: 1.15rem;
            margin-bottom: 0.3rem;
            text-align: left;
        }
        .option-box:hover {
            border-color: var(--teal);
            background: #F8FAFB;
        }

        /* 紧凑档案条目 - 去空 */
        .archive-entry {
            border-bottom: 0.5px solid rgba(48, 45, 45, 0.02);
            padding: 0.65rem 0; 
            transition: all 0.2s ease;
        }
        .archive-entry:hover { opacity: 0.5; cursor: help; }

        .pagination-dot {
            width: 4px; height: 4px;
            background: #EAEAEA;
            border-radius: 50%;
            transition: all 0.3s;
        }
        .pagination-dot.active { background: var(--teal); transform: scale(1.2); }

        #modal-overlay {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(48, 45, 45, 0.98);
            backdrop-filter: blur(20px);
            z-index: 100;
            align-items: center;
            justify-content: center;
            padding: 40px;
        }

        .qr-placeholder {
            width: 65px; height: 65px;
            background: #FFF;
            border: 0.5px solid rgba(0,0,0,0.03);
            margin: 0 auto;
            display: flex; align-items: center; justify-content: center;
        }

        ::-webkit-scrollbar { width: 0; }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center">

    <!-- 档案详情 -->
    <div id="modal-overlay" onclick="closeModal()">
        <div class="bg-white p-10 max-w-xs w-full text-center fade-in shadow-2xl" onclick="event.stopPropagation()">
            <div class="metadata mb-6" style="color:var(--teal)">Coordinate Archive</div>
            <h4 id="modal-title" class="text-xl serif font-black mb-6 text-[#302D2D]"></h4>
            <p id="modal-content" class="text-[12px] leading-relaxed text-gray-500 font-light text-justify"></p>
            <button onclick="closeModal()" class="mt-12 text-[9px] tracking-widest uppercase border-b border-gray-200 pb-1 text-[#302D2D]">Close / 关闭</button>
        </div>
    </div>

    <!-- 1. 验证页 -->
    <section id="access-screen" class="min-h-screen w-full flex flex-col items-center justify-center space-y-20 fade-in theme-charcoal px-12">
        <div class="text-center space-y-4">
            <div class="metadata opacity-40">Entry Control</div>
            <h2 class="text-3xl serif font-light tracking-widest italic">女哲学家 ・ 思想坐标</h2>
        </div>
        <div class="space-y-10 w-full max-w-[180px] text-center">
            <input type="password" id="access-code" class="w-full bg-transparent border-b border-[#4A4646] py-2 text-center text-xl focus:outline-none focus:border-white transition-all font-light tracking-[0.4em]" placeholder="••••">
            <button onclick="verifyAccess()" class="w-full py-4 bg-white text-[#302D2D] text-[10px] tracking-widest uppercase font-bold active:scale-95">Unlock</button>
        </div>
        <p class="text-[9px] tracking-[0.4em] uppercase opacity-30 italic pt-20">© 云树cloudtree</p>
    </section>

    <!-- 2. 欢迎页 -->
    <section id="welcome-screen" class="hidden min-h-screen w-full flex flex-col items-center justify-center text-center space-y-36 fade-in theme-charcoal px-10">
        <header class="space-y-8">
            <div class="metadata opacity-30">Conceptual Map 2026</div>
            <h1 class="text-5xl md:text-6xl serif font-black tracking-tighter leading-tight italic text-white">解锁女哲学家<br>精神坐标</h1>
        </header>
        <button onclick="startQuiz()" class="px-16 py-6 bg-white text-[#302D2D] text-[10px] tracking-[0.6em] uppercase font-black shadow-2xl active:scale-95">START</button>
        <p class="text-[8px] tracking-[0.5em] uppercase opacity-20 italic">Designed by 云树cloudtree</p>
    </section>

    <!-- 3. 测试页 -->
    <section id="quiz-screen" class="hidden w-full max-w-xl px-12 py-20 flex flex-col min-h-screen fade-in bg-[#FBFCFA]">
        <div class="space-y-12">
            <div class="space-y-6">
                <div class="w-full h-[1px] bg-gray-100"><div id="progress" class="h-full bg-[#169cb2] w-0 transition-all duration-700"></div></div>
                <div class="flex justify-between metadata">
                    <span id="question-num" style="color:var(--teal)">Phase 01 / 20</span>
                    <button id="back-btn" onclick="prevQuestion()" class="hidden opacity-40 hover:opacity-100 uppercase tracking-widest text-[8px]">← Prev</button>
                </div>
            </div>
            <h2 id="question-text" class="text-xl serif leading-relaxed font-medium text-[#302D2D]"></h2>
            <div id="options-container" class="space-y-0.5 pt-4"></div>
        </div>
        <p class="text-[8px] text-center mt-auto pt-10 tracking-[0.4em] uppercase opacity-10 italic">Archive Study 云树cloudtree</p>
    </section>

    <!-- 4. 结果页 (紧凑排版 - 无多余空间) -->
    <section id="result-screen" class="hidden w-full flex flex-col items-center min-h-screen fade-in pb-40 relative">
        <div class="fixed inset-0 theme-charcoal -z-10"></div>
        
        <div class="w-full max-w-[375px] px-4 py-12">
            <!-- 捕捉区域 -->
            <div id="capture-area" class="bg-[#FBFCFA] p-6 md:p-8 shadow-2xl space-y-4 border border-[rgba(0,0,0,0.01)]">
                
                <div class="long-strip-container">
                    
                    <!-- 报告标题 (雅青色应用) -->
                    <div class="bg-white p-8 border border-[rgba(48,45,45,0.02)] text-center space-y-2">
                        <div class="metadata" style="color:var(--teal)">Detection Final Report</div>
                        <h2 class="text-2xl serif font-black italic tracking-tighter uppercase" style="color:var(--teal)">女哲学家探测报告</h2>
                        <div class="w-6 h-[1px] bg-[#169cb2] mx-auto opacity-30 mt-1"></div>
                    </div>

                    <!-- 精神原型 (名字调小, 雅青色) -->
                    <div class="bg-white p-6 border border-[rgba(48,45,45,0.02)] relative">
                        <div class="metadata mb-4 text-[#A39F9F] font-bold">Primary Archetype</div>
                        <div class="space-y-4">
                            <h3 id="mentor-name" class="text-xl serif font-bold tracking-widest uppercase" style="color:var(--teal)"></h3>
                            <p id="mentor-quote" class="text-[13px] italic text-gray-500 font-light leading-relaxed"></p>
                            <div class="pt-4 border-t border-gray-50">
                                <span class="metadata">Main Work / 代表作:</span>
                                <p id="mentor-work" class="text-[11px] font-bold mt-1 text-[#302D2D] uppercase tracking-widest"></p>
                            </div>
                        </div>
                    </div>

                    <!-- 思想符文 (强化清晰度) -->
                    <div class="bg-white p-8 border border-[rgba(48,45,45,0.02)] flex flex-col items-center">
                        <div class="metadata mb-6 self-start">Soul Sigil / 思想符文</div>
                        <div class="w-full aspect-square">
                            <canvas id="radarChart"></canvas>
                        </div>
                    </div>

                    <!-- 解读 -->
                    <div class="bg-white p-6 border border-[rgba(48,45,45,0.02)] text-left">
                        <div class="metadata mb-4 text-[#A39F9F]">Interpretation / 分析</div>
                        <p id="result-desc" class="text-[12px] leading-relaxed text-gray-600 font-light text-justify"></p>
                    </div>

                    <!-- 档案馆 (自适应高度) -->
                    <div class="bg-white p-6 border border-[rgba(48,45,45,0.02)]">
                        <div class="flex justify-between items-center mb-6">
                            <div class="metadata">解锁更多女哲学家</div>
                            <button onclick="changeMapPage(1)" class="text-[8px] border border-[#169cb2] text-[#169cb2] px-2 py-0.5 font-bold">REFRESH</button>
                        </div>
                        <div id="full-map-archive" class="space-y-0">
                            <!-- 内容动态自适应 -->
                        </div>
                        <div class="flex justify-center gap-1.5 mt-6" id="pagination-dots"></div>
                    </div>

                    <!-- 推荐书单 -->
                    <div class="p-8 bg-[#F7F7F5] border border-[rgba(48,45,45,0.02)] shadow-inner">
                        <div class="metadata mb-8">Bibliography / 书单</div>
                        <div id="book-list" class="space-y-3 text-gray-500 font-light text-[11px]"></div>
                    </div>

                    <!-- 延续思考 (预留二维码) -->
                    <div class="p-8 bg-white border border-[rgba(48,45,45,0.02)] text-center space-y-6">
                        <div class="metadata" style="color:var(--teal)">Connect</div>
                        <div class="qr-placeholder">
                             <!-- 请将图片命名为 xhs-qr.png -->
                             <img src="xhs-qr.png" alt="QR" class="w-12 h-12 grayscale opacity-20" onerror="this.src='data:image/svg+xml,%3Csvg xmlns=\'http://www.w3.org/2000/svg\' width=\'40\' height=\'40\' viewBox=\'0 0 24 24\' fill=\'none\' stroke=\'%23169cb2\' stroke-width=\'1.5\'%3E%3Crect x=\'3\' y=\'3\' width=\'7\' height=\'7\'/%3E%3Crect x=\'14\' y=\'3\' width=\'7\' height=\'7\'/%3E%3Crect x=\'3\' y=\'14\' width=\'7\' height=\'7\'/%3E%3Cpath d=\'M14 14h3m3 0h1m-4 3h1m3 0h1m-4 3h1m3 0h1\'/%3E%3C/svg%3E'">
                        </div>
                        <p class="text-[8px] text-gray-400 tracking-widest uppercase">© 云树cloudtree</p>
                    </div>
                </div>
            </div>

            <!-- 操作 -->
            <div class="grid grid-cols-2 gap-4 mt-12 px-2">
                <button onclick="location.reload()" class="py-5 bg-white/5 border border-white/20 text-white text-[10px] tracking-widest uppercase rounded-sm">Retry</button>
                <button id="save-btn" onclick="saveAsImage()" class="py-5 bg-white text-[#302D2D] text-[10px] tracking-widest uppercase rounded-sm font-bold shadow-2xl active:scale-95 transition-all">Save Image</button>
            </div>
        </div>
    </section>

    <script>
        const dictionary = {
            "父权制": "系统性地将资源与权力赋予男性的制度，涉及法律、文化与心理的全方位统治。",
            "他者": "波伏娃术语。指女性在文明中被定义为男性的附庸，存在意义由他者裁定而非自发产生。",
            "平庸之恶": "汉娜·阿伦特术语。指在体制下拒绝思考、盲从规则而导致的道德灾难。",
            "表演性": "朱迪斯·巴特勒术语。指性别并非天生本质，而是通过反复言行表演构建出的效应。",
            "赛博格": "唐娜·哈拉维术语。打破二元对立的隐喻，主张流动的、混杂的后人类身份范式。",
            "交织性": "指种族、性别、阶级压迫并非孤立存在，而是相互交织强化的系统。",
            "注视": "西蒙娜·薇依术语。指一种非占有式的、极其慷慨的、对他者苦难的深度观照。"
        };

        const philoData = {
            hypatia: { name: "海帕提娅", quote: "保留你思考的权利。因为即使是错误的思考，也比不思考要好。", work: "《天文学评注》", desc: "你是理性的坚实拥簇。在混乱中仰望永恒的逻辑与秩序，追求超越时代的纯粹真理，在思辨中获得自由。", tags: ["理智", "数学"], books: ["《海帕提娅传》"], dims: [95, 20, 30, 10, 80, 70], map: "数学、天文学、新柏拉图主义" },
            wollstonecraft: { name: "玛丽·沃斯通克拉夫特", quote: "我不希望女性拥有支配男性的权力，而是拥有支配她们自身权力的权利。", work: "《为女权辩护》", desc: "你是启蒙之光。坚信理性没有性别，尊严源于经济与精神的双重独立。", tags: ["权利", "独立"], books: ["《为女权辩护》"], dims: [70, 80, 50, 60, 80, 95], map: "启蒙主义、公民权利" },
            arendt: { name: "汉娜·阿伦特", quote: "平庸之恶源于拒绝思考，拒绝站在他人的立场去感知世界。", work: "《人的境况》", desc: "公共领域守护者。认为人的本质在于“行动”与“对话”，自由在共同担当中显现。", tags: ["行动", "反平庸"], books: ["《人的境况》", "《平庸之恶》"], dims: [80, 95, 60, 70, 40, 90], map: "政治哲学、积极行动" },
            beauvoir: { name: "西蒙娜·德·波伏娃", quote: "女人不是生来就是女人的，而是变成女人的。", work: "《第二性》", desc: "存在主义灵魂。生命是一场永恒的“自我生成”，视自由为最高责任与天赋。", tags: ["生成", "主体性"], books: ["《第二性》"], dims: [75, 75, 40, 90, 95, 75], map: "存在主义、生成论" },
            weil: { name: "西蒙娜·薇依", quote: "关注是灵魂中最稀有、最纯粹的慷慨形式。", work: "《扎根》", desc: "近乎神圣的共情力。认为思想植根于对劳动的尊重和对他人的‘注视’。", tags: ["注视", "神圣"], books: ["《扎根》"], dims: [60, 60, 95, 40, 50, 80], map: "神秘主义、劳工正义" },
            butler: { name: "朱迪斯·巴特勒", quote: "身份不是固定的事实，而是一种被迫的重复表演。", work: "《性别麻烦》", desc: "规则解构者。洞察到社会规范的表演本质，在权力的缝隙中寻找反抗。", tags: ["表演", "解构"], books: ["《性别麻烦》"], dims: [70, 60, 50, 95, 85, 60], map: "后现代、酷儿理论" },
            haraway: { name: "唐娜·哈拉维", quote: "我宁愿做一个赛博格，也不愿做一个女神。", work: "《赛博格宣言》", desc: "未来叙事者。打破自然与文化的边界，拥抱科技与生物的混杂流动的身份范式。", tags: ["赛博格", "后人类"], books: ["《赛博格宣言》"], dims: [70, 65, 40, 95, 70, 60], map: "科学论、后人类主义" },
            hooks: { name: "贝尔·胡克斯", quote: "爱是走向自由的一种行动。", work: "《关于爱的一切》", desc: "交织性先锋。正义必须包含爱，解放必须打破阶级、性别与种族的连锁。", tags: ["爱", "交叉性"], books: ["《关于爱的一切》"], dims: [60, 80, 90, 85, 60, 90], map: "黑人女性主义、关怀政治" },
            davis: { name: "安吉拉·戴维斯", quote: "自由是一场无止境的奋斗。", work: "《女性，种族与阶级》", desc: "革命者。女性解放不能脱离反资本主义叙事。致力于废除压迫结构。", tags: ["革命", "斗争"], books: ["《女性，种族与阶级》"], dims: [50, 98, 60, 85, 50, 95], map: "马克思主义女性主义" },
            nussbaum: { name: "玛莎·努斯鲍姆", quote: "正义需要一种富有成效的情感。", work: "《能力的创造》", desc: "理智情感主义者。用‘能力方法’衡量人的福祉，认为情感即认知。", tags: ["能力", "福祉"], books: ["《能力的创造》"], dims: [85, 75, 85, 40, 60, 90], map: "政治哲学、能力进路" },
            stein: { name: "艾德丝·施泰因", quote: "每一个进入灵魂的词，都是一种命运。", work: "《对共情的本质研究》", desc: "现象学朝圣者。在共情深处探寻人的本质，在理性与神性之间寻找融合。", tags: ["现象学", "本质"], books: ["《对共情的本质研究》"], dims: [90, 30, 90, 20, 70, 60], map: "现象学、共情研究" },
            luxemburg: { name: "罗莎·卢森堡", quote: "自由永远是那些思考方式不同的人的自由。", work: "《社会改良还是革命》", desc: "思想闪电。主张最彻底的民主与自发的行动，用生命博弈教条。", tags: ["民主", "自发"], books: ["《社会改良还是革命》"], dims: [80, 98, 50, 90, 40, 95], map: "马克思主义、反威权" },
            mernissi: { name: "法蒂玛·梅尔尼西", quote: "如果我们不书写历史，别人就会替我们书写。", work: "《后宫背后的面纱》", desc: "跨文化破墙者。在宗教、历史与平权间寻找连接，通过重读经典挑战偏见。", tags: ["文本", "跨文化"], books: ["《后宫背后的面纱》"], dims: [80, 70, 60, 85, 75, 85], map: "伊斯兰女性主义" },
            foot: { name: "菲利帕·福特", quote: "美德是人类繁荣的一种卓越表现。", work: "《美德与罪过》", desc: "现代美德伦理复兴者。主张回归到人的性格与卓越。逻辑严密的观察家。", tags: ["美德", "逻辑"], books: ["《美德与罪过》"], dims: [90, 40, 70, 30, 80, 80], map: "美德伦理学、分析哲学" },
            anscombe: { name: "伊丽莎白·安斯康姆", quote: "意图是通向行动本质的钥匙。", work: "《意图》", desc: "逻辑剖析者。挑战伦理学框架，从行动的意图出发理解生命。理性的利刃。", tags: ["解析", "意图"], books: ["《意图》"], dims: [98, 30, 40, 50, 85, 70], map: "分析伦理学、行动论" }
        };

        const questions = [
            { t: "面对社会流传的‘共识’，你的本能倾向是：", o: [
                { t: "分析其逻辑是否严密且符合事实证据", p: ["hypatia", "anscombe", "foot"] },
                { t: "反思这背后是由谁定义的权力规训与管理", p: ["butler", "haraway", "mernissi"] },
                { t: "关心它是否会伤害具体个人的生存尊严与处境", p: ["weil", "hooks", "nussbaum"] },
                { t: "发起一场集体的公共行动来质疑并挑战它", p: ["arendt", "luxemburg", "davis"] }
            ]},
            { t: "关于女性的‘身体’，你认为最无法妥协的防线是：", o: [
                { t: "解构审美定义：挑战由父权制构建的‘美学极权’", p: ["butler", "mernissi"] },
                { t: "绝对的选择自由：我是自己身体的第一负责人", p: ["beauvoir", "wollstonecraft"] },
                { t: "生存主权：在堕胎、生育等议题上的法律自主", p: ["davis", "hooks"] },
                { t: "作为承载生命厚度、苦难与注视的媒介", p: ["weil", "stein"] }
            ]},
            { t: "在公共讨论中哪种现象最让你感到愤怒？", o: [
                { t: "由于盲从权威或规则而产生的平庸之恶", p: ["arendt", "hypatia"] },
                { t: "论证逻辑的极度匮乏与对基本事实的漠视", p: ["anscombe", "foot"] },
                { t: "对弱势群体困境表现出的傲慢与冷漠", p: ["weil", "nussbaum"] },
                { t: "试图将复杂的个体强行塞进某种身份标签中", p: ["butler", "haraway"] }
            ]}
        ];

        let curIdx = 0, scoreMap = {}, historyArr = [];
        Object.keys(philoData).forEach(k => scoreMap[k] = 0);

        let currentMapPage = 0;
        const mapPageSize = 5;

        function verifyAccess() {
            const input = document.getElementById('access-code').value.trim().toLowerCase();
            if (input === 'cloudtree') {
                document.getElementById('access-screen').classList.add('hidden');
                document.getElementById('welcome-screen').classList.remove('hidden');
            } else {
                const msg = document.getElementById('err-msg');
                if(msg){ msg.style.opacity = 1; setTimeout(() => msg.style.opacity = 0, 2000); }
            }
        }

        function showDefinition(word) {
            document.getElementById('modal-title').innerText = word;
            const data = Object.values(philoData).find(p => p.name === word);
            document.getElementById('modal-content').innerText = dictionary[word] || data?.desc || "存档内容加载中...";
            document.getElementById('modal-overlay').style.display = 'flex';
        }
        function closeModal() { document.getElementById('modal-overlay').style.display = 'none'; }

        function startQuiz() {
            document.getElementById('welcome-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            showQ();
        }

        function showQ() {
            const q = questions[curIdx % questions.length];
            document.getElementById('question-num').innerText = `Phase ${String(curIdx + 1).padStart(2, '0')} / 20`;
            let text = q.t;
            Object.keys(dictionary).forEach(word => {
                const regex = new RegExp(word, 'g');
                text = text.replace(regex, `<span class="term-tag" style="cursor:help; color:var(--teal); border-bottom: 0.5px dotted #169cb2;" onclick="showDefinition('${word}')">${word}</span>`);
            });
            document.getElementById('question-text').innerHTML = text;
            document.getElementById('progress').style.width = `${((curIdx) / 20) * 100}%`;
            document.getElementById('back-btn').style.display = curIdx > 0 ? 'inline-block' : 'none';

            const container = document.getElementById('options-container');
            container.innerHTML = '';
            q.o.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "w-full p-4 text-left option-box text-[#302D2D] shadow-sm";
                btn.innerText = opt.t;
                btn.onclick = () => {
                    historyArr.push(opt.p);
                    opt.p.forEach(k => scoreMap[k]++);
                    if (curIdx < 19) { curIdx++; showQ(); } else { showResult(); }
                };
                container.appendChild(btn);
            });
        }

        function prevQuestion() {
            if (curIdx > 0) {
                const lastKeys = historyArr.pop();
                lastKeys.forEach(k => scoreMap[k]--);
                curIdx--; showQ();
            }
        }

        function renderMapPage(pageIndex) {
            const container = document.getElementById('full-map-archive');
            const keys = Object.keys(philoData);
            const start = pageIndex * mapPageSize;
            const groupKeys = keys.slice(start, start + mapPageSize);

            container.innerHTML = groupKeys.map(k => `
                <div class="archive-entry" onclick="showDefinition('${philoData[k].name}')">
                    <div class="flex justify-between items-end">
                        <span class="text-[13px] font-bold text-[#302D2D] tracking-tighter">${philoData[k].name}</span>
                        <span class="text-[8px] uppercase tracking-[0.1em] text-[#A39F9F] mb-[1px]">${philoData[k].map}</span>
                    </div>
                </div>
            `).join('');

            const dots = document.getElementById('pagination-dots');
            dots.innerHTML = [0,1,2].map(i => `<div class="pagination-dot ${i === pageIndex ? 'active' : ''}"></div>`).join('');
        }

        function changeMapPage(offset) {
            currentMapPage = (currentMapPage + offset + 3) % 3;
            renderMapPage(currentMapPage);
        }

        function showResult() {
            document.getElementById('quiz-screen').classList.add('hidden');
            document.getElementById('result-screen').classList.remove('hidden');

            const sorted = Object.keys(scoreMap).sort((a,b) => scoreMap[b] - scoreMap[a]);
            const data = philoData[sorted[0]];

            document.getElementById('mentor-name').innerText = data.name;
            document.getElementById('mentor-quote').innerText = `“${data.quote}”`;
            document.getElementById('mentor-work').innerText = data.work;
            document.getElementById('result-desc').innerText = data.desc;
            document.getElementById('book-list').innerHTML = data.books.map(b => `<div class="py-1.5 italic text-[11px] text-gray-500">· ${b}</div>`).join('');
            
            renderMapPage(0);

            new Chart(document.getElementById('radarChart').getContext('2d'), {
                type: 'radar',
                data: {
                    labels: ['理智', '行动', '慈悲', '颠覆', '主体', '正义'],
                    datasets: [{
                        data: data.dims,
                        backgroundColor: 'rgba(22, 156, 178, 0.22)',
                        borderColor: '#169cb2',
                        borderWidth: 1.5,
                        pointBackgroundColor: '#169cb2',
                        pointRadius: 2
                    }]
                },
                options: {
                    plugins: { legend: { display: false } },
                    scales: { 
                        r: { 
                            min: 0, max: 100,
                            ticks: { display: false }, 
                            grid: { color: 'rgba(48, 45, 45, 0.05)' }, 
                            angleLines: { color: 'rgba(48, 45, 45, 0.05)' },
                            pointLabels: { font: { size: 10, family: 'Noto Serif SC', weight: '500' }, color: '#302D2D' } 
                        } 
                    }
                }
            });
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        async function saveAsImage() {
            const btn = document.getElementById('save-btn');
            btn.innerText = "Processing...";
            const canvas = await html2canvas(document.getElementById('capture-area'), { scale: 3, backgroundColor: "#FBFCFA" });
            const link = document.createElement('a');
            link.download = `Detection_Report.png`;
            link.href = canvas.toDataURL();
            link.click();
            btn.innerText = "Save Image";
        }
    </script>
</body>
</html>